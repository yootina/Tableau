## 사용자가 상호작용 할 수 있는 시각화와 대시보드

카페인 용량 80mg이 아니라 100mg을 기준으로 보고 싶다면 어떻게 해야할까요? 매번 계산식을 수정해야 할까요? 
통합문서를 편집할 수 없고 조회만 가능한 사용자를 위해서는 어떻게 해야할까요? 
이러한 문제를 해결할 수 있는 방법 중 하나가 바로 매개변수 입니다. 
매개변수를 이용해서 어떻게 시각화와 사용자가 상호작용 할 수 있는지 알아볼 예정

### 1. 매개 변수를 사용하여 측정값 변경하기1 & 마크 색상 표현하기 
- 하나의 시각화에서 여러 개의 측정값을 변경해보고, 선택한 카페인 함유량에 따라서 카테고리 색상이 표시되도록 합니다. 

아래처럼 좀 더 동적으로 데이터를 분석할 수 있도록 해볼까요?   
(1) “매개 변수 만들기”를 실행해 주세요.   
(2) 아래와 같은 정보로 “측정값 선택” 매개 변수를 만듭니다.
    - 이름 : 측정값 선택
    - 데이터 유형 : 문자열
    - 허용 가능한 값 : 목록     
    - 값 목록 : 칼로리, 카페인, 당류   
(3) 2번 단계에서 만든 매개 변수를 이용하는 필드를 만들어야겠죠? 
    “선택한 측정값”이라는 이름으로 계산된 필드를 만들어 주세요. 

    [측정값 선택] 매개변수에서 ‘칼로리’를 선택했다면 [칼로리(Kcal)] 측정값을.. 
                                                 ‘카페인’을 선택했다면 [카페인(Mg)] 측정값을...
                                                 ‘당류’를 선택했다면 [당류(G)]를가져오도록 작성!   
```python
IF [측정값 선택] = '칼로리' THEN [칼로리(Kcal)] 
ELSEIF [측정값 선택] = '카페인' THEN [카페인(MG)]
ELSEIF [측정값 선택] = '당류' THEN .......
END
```
또는
```python
CASE [측정값 선택] 
WHEN '칼로리' THEN [칼로리(Kcal)] 
WHEN '카페인' THEN ...
WHEN '당류' THEN ..
END
```
(4) 아래와 같은 정보로 “카페인 함유량 선택” 매개 변수를 만듭니다. 
    - 이름 : 카페인 함유량 선택
    - 데이터 유형 : 정수
    - 허용 가능한 값 : 범위
    - 값 범위 : 최소값 0, 최대값 200, 단계 크기 20



(5) 4번 단계에서 만든 매개변수를 이용하는 필드도 만들어 봅시다. 
    이 계산식은 “카페인 함유량 선택” 매개 변수에서 선택한 값보다 높은 값과 낮은 값을 구분해서 볼 수 있도록 마크 색상을 표현하는데 사용됩니다.

"카페인 > 선택한" 카페인 이라는 이름으로 계산된 필드를 만듭니다.

“평균 카페인”이 [카페인 함유량 선택] 보다 크다면 ‘선택한 카페인보다 많이 들음’, 아니라면 ‘선택한 카페인보다 적게 들음’ 이라고 작성해 보세요.      
```python
IF AVG([카페인(Mg)]) > [카페인 함유량 선택] THEN '선택한 카페인보다 많이 들음'
ELSE ...
END
```
(6) “카테고리”와 “선택한 측정값”을 행과 열 선반에 놓아주세요.    
(7) “선택한 측정값”의 집계 형태를 “평균”으로 변경해주세요.    
(8) “카페인 > 선택한 카페인”을 마크의 색상에 놓아주세요.    
(9) 시트 제목에 파라미터를 “삽입”하여, “측정값 선택“ 값에 따라서 제목이 변경되게 해보세요    
- 제목을 더블 클릭하세요.   
- 원하는 위치에 커서를 두고, 삽입 > 매개 변수.측정값 선택  클릭   


### 2. 매개 변수를 사용하여 측정값 변경하기2

아래 시각화와 같이 선택한 측정값에 따라서 두 측정값의 상관 관계를 살펴보는 동적 시각화를 만들어 봅니다.

1. 필요한 매개 변수와 매개 변수를 활용할 수 있는 계산식을 만들어 봅시다.
    1) 첫번째 매개 변수
        - 이름 : X축 선택
        - 데이터 유형 : 문자열
        - 허용 가능한 값 : 목록
        - 값 목록 : 카페인, 칼로리, 나트륨, 당류
     
     2) 두번째 매개 변수 
        - 이름 : Y축 선택
        - 데이터 유형 : 문자열
        - 허용 가능한 값 : 목록
        - 값 목록 : 카페인, 칼로리, 나트륨, 당류
     
     3) 첫번째 매개 변수를 위한 계산된 필드 
          - 이름 : X축 (열)
     
     4) 두번째 매개 변수를 위한 계산된 필드 
          - 이름 : Y축 (행)

2. “X축 (열)”, “Y축 (행)”을 각각 열과 행 선반에 놓아주세요. 

3. X축, Y축 각각의 집계 형태를 “평균”으로 변경해주세요. 

4. 세부 정보 수준에 “카테고리”와 “메뉴명”을 넣어주세요. (“카테고리”는 3번 대시보드 동작에서 사용됩니다.)

5. “분석 탭”에서 평균 라인을 테이블에 넣어 주세요! 



### 3. 대시보드 동작 적용하기
#### 대시보드 동작을 이용해 해당 카테고리 별 제품을 하이라이트


1. 앞에서 만들어 놓은 2개의 시트를 이용해서 대시보드를 만들어 주세요. 

2. 메뉴 > 대시보드 > 동작 클릭해주세요.

3.  동작 추가 > 하이라이트 선택해주세요.

4. 원본 시트(카테고리 별 카페인)와 대상 시트(당류과 칼로리의 상관관계)를 적절하게 선택해주세요. 

5. 동작 실행 조건은 “마우스 오버”로 합니다. 

6. 대상 하이라이트는 선택한 필드에서 “카테고리”만 선택해 주세요.   
     * 대상 시트에 하이라이트가 되는 필드가 없다면, 무엇을 하이라이트 해야되는지 모르니 당연히 올바르게 작동하지 않곘죠? 
        그래서 우린 2번 과제에서 미리 “카테고리”를 시트에 추가해 둔 것이죠 !!! 

7. 원하는 형태로 작동하는지 확인해 보세요
